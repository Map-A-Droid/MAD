/**
 * Minified by jsDelivr using UglifyJS v3.3.21.
 * Original file: /npm/s2-geometry@1.2.10/src/s2geometry.js
 */
!function(s){"use strict";var h=s.S2={L:{}};h.L.LatLng=function(t,e,r){var n=parseFloat(t,10),o=parseFloat(e,10);if(isNaN(n)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+e+")");return!0!==r&&(n=Math.max(Math.min(n,90),-90),o=(o+180)%360+(o<-180||180===o?180:-180)),{lat:n,lng:o}},h.L.LatLng.DEG_TO_RAD=Math.PI/180,h.L.LatLng.RAD_TO_DEG=180/Math.PI,h.LatLngToXYZ=function(t){var e=h.L.LatLng.DEG_TO_RAD,r=t.lat*e,n=t.lng*e,o=Math.cos(r);return[Math.cos(n)*o,Math.sin(n)*o,Math.sin(r)]},h.XYZToLatLng=function(t){var e=h.L.LatLng.RAD_TO_DEG,r=Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1])),n=Math.atan2(t[1],t[0]);return h.L.LatLng(r*e,n*e)};h.XYZToFaceUV=function(t){var e,r,n=(e=t,(r=[Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])])[1]<r[0]?r[2]<r[0]?0:2:r[2]<r[1]?1:2);return t[n]<0&&(n+=3),[n,function(t,e){var r,n;switch(t){case 0:r=e[1]/e[0],n=e[2]/e[0];break;case 1:r=-e[0]/e[1],n=e[2]/e[1];break;case 2:r=-e[0]/e[2],n=-e[1]/e[2];break;case 3:r=e[2]/e[0],n=e[1]/e[0];break;case 4:r=e[2]/e[1],n=-e[0]/e[1];break;case 5:r=-e[1]/e[2],n=-e[0]/e[2];break;default:throw{error:"Invalid face"}}return[r,n]}(n,t)]},h.FaceUVToXYZ=function(t,e){var r=e[0],n=e[1];switch(t){case 0:return[1,r,n];case 1:return[-r,1,n];case 2:return[-r,-n,1];case 3:return[-1,-n,-r];case 4:return[n,-1,-r];case 5:return[n,r,-1];default:throw{error:"Invalid face"}}};var e=function(t){return.5<=t?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))};h.STToUV=function(t){return[e(t[0]),e(t[1])]};var r=function(t){return 0<=t?.5*Math.sqrt(1+3*t):1-.5*Math.sqrt(1-3*t)};h.UVToST=function(t){return[r(t[0]),r(t[1])]},h.STToIJ=function(t,e){var r=1<<e,n=function(t){var e=Math.floor(t*r);return Math.max(0,Math.min(r-1,e))};return[n(t[0]),n(t[1])]},h.IJToST=function(t,e,r){var n=1<<e;return[(t[0]+r[0])/n,(t[1]+r[1])/n]};var S=function(t,e,r,n){if(0==n){1==r&&(e.x=t-1-e.x,e.y=t-1-e.y);var o=e.x;e.x=e.y,e.y=o}},n=function(t,e,r,n){var o={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof n&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var a=n%2?"d":"a",i=[],l=r-1;0<=l;l--){var u=1<<l,c=o[a][2*(t&u?1:0)+(e&u?1:0)];i.push(c[0]),a=c[1]}return i};h.S2Cell=function(){},h.S2Cell.FromHilbertQuadKey=function(t){var e,r,n,o,a,i,l=t.split("/"),u=parseInt(l[0]),c=l[1],s=c.length,f={x:0,y:0};for(e=s-1;0<=e;e--)r=s-e,a=o=0,"1"===(n=c[e])?a=1:"2"===n?a=o=1:"3"===n&&(o=1),i=Math.pow(2,r-1),S(i,f,o,a),f.x+=i*o,f.y+=i*a;if(u%2==1){var g=f.x;f.x=f.y,f.y=g}return h.S2Cell.FromFaceIJ(parseInt(u),[f.x,f.y],r)},h.S2Cell.FromLatLng=function(t,e){if(!t.lat&&0!==t.lat||!t.lng&&0!==t.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var r=h.LatLngToXYZ(t),n=h.XYZToFaceUV(r),o=h.UVToST(n[1]),a=h.STToIJ(o,e);return h.S2Cell.FromFaceIJ(n[0],a,e)},h.S2Cell.FromFaceIJ=function(t,e,r){var n=new h.S2Cell;return n.face=t,n.ij=e,n.level=r,n},h.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},h.S2Cell.prototype.getLatLng=function(){var t=h.IJToST(this.ij,this.level,[.5,.5]),e=h.STToUV(t),r=h.FaceUVToXYZ(this.face,e);return h.XYZToLatLng(r)},h.S2Cell.prototype.getCornerLatLngs=function(){for(var t=[],e=[[0,0],[0,1],[1,1],[1,0]],r=0;r<4;r++){var n=h.IJToST(this.ij,this.level,e[r]),o=h.STToUV(n),a=h.FaceUVToXYZ(this.face,o);t.push(h.XYZToLatLng(a))}return t},h.S2Cell.prototype.getFaceAndQuads=function(){var t=n(this.ij[0],this.ij[1],this.level,this.face);return[this.face,t]},h.S2Cell.prototype.toHilbertQuadkey=function(){var t=n(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+t.join("")},h.latLngToNeighborKeys=h.S2Cell.latLngToNeighborKeys=function(t,e,r){return h.S2Cell.FromLatLng({lat:t,lng:e},r).getNeighbors().map(function(t){return t.toHilbertQuadkey()})},h.S2Cell.prototype.getNeighbors=function(){var t=function(t,e,r){var n=1<<r;if(0<=e[0]&&0<=e[1]&&e[0]<n&&e[1]<n)return h.S2Cell.FromFaceIJ(t,e,r);var o=h.IJToST(e,r,[.5,.5]),a=h.STToUV(o),i=h.FaceUVToXYZ(t,a),l=h.XYZToFaceUV(i);return t=l[0],a=l[1],o=h.UVToST(a),e=h.STToIJ(o,r),h.S2Cell.FromFaceIJ(t,e,r)},e=this.face,r=this.ij[0],n=this.ij[1],o=this.level;return[t(e,[r-1,n],o),t(e,[r,n-1],o),t(e,[r+1,n],o),t(e,[r,n+1],o)]},h.FACE_BITS=3,h.MAX_LEVEL=30,h.POS_BITS=2*h.MAX_LEVEL+1,h.facePosLevelToId=h.S2Cell.facePosLevelToId=h.fromFacePosLevel=function(t,e,r){var n,o,a,i=s.dcodeIO&&s.dcodeIO.Long||require("long");for(r||(r=e.length),e.length>r&&(e=e.substr(0,r)),n=i.fromString(t.toString(10),!0,10).toString(2);n.length<h.FACE_BITS;)n="0"+n;for(o=i.fromString(e,!0,4).toString(2);o.length<2*r;)o="0"+o;for(a=n+o,a+="1";a.length<h.FACE_BITS+h.POS_BITS;)a+="0";return i.fromString(a,!0,2).toString(10)},h.keyToId=h.S2Cell.keyToId=h.toId=h.toCellId=h.fromKey=function(t){var e=t.split("/");return h.fromFacePosLevel(e[0],e[1],e[1].length)},h.idToKey=h.S2Cell.idToKey=h.S2Cell.toKey=h.toKey=h.fromId=h.fromCellId=h.S2Cell.toHilbertQuadkey=h.toHilbertQuadkey=function(t){for(var e=s.dcodeIO&&s.dcodeIO.Long||require("long"),r=e.fromString(t,!0,10).toString(2);r.length<h.FACE_BITS+h.POS_BITS;)r="0"+r;for(var n=r.lastIndexOf("1"),o=r.substring(0,3),a=r.substring(3,n),i=a.length/2,l=e.fromString(o,!0,2).toString(10),u=e.fromString(a,!0,2).toString(4);u.length<i;)u="0"+u;return l+"/"+u},h.keyToLatLng=h.S2Cell.keyToLatLng=function(t){return h.S2Cell.FromHilbertQuadKey(t).getLatLng()},h.idToLatLng=h.S2Cell.idToLatLng=function(t){var e=h.idToKey(t);return h.keyToLatLng(e)},h.S2Cell.latLngToKey=h.latLngToKey=h.latLngToQuadkey=function(t,e,r){if(isNaN(r)||r<1||30<r)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return h.S2Cell.FromLatLng({lat:t,lng:e},r).toHilbertQuadkey()},h.stepKey=function(t,e){var r,n=s.dcodeIO&&s.dcodeIO.Long||require("long"),o=t.split("/"),a=o[0],i=o[1],l=o[1].length,u=n.fromString(i,!0,4);0<e?r=u.add(Math.abs(e)):e<0&&(r=u.subtract(Math.abs(e)));var c=r.toString(4);for("0"===c&&console.warning(new Error("face/position wrapping is not yet supported"));c.length<l;)c="0"+c;return a+"/"+c},h.S2Cell.prevKey=h.prevKey=function(t){return h.stepKey(t,-1)},h.S2Cell.nextKey=h.nextKey=function(t){return h.stepKey(t,1)}}("undefined"!=typeof module?module.exports:window);
